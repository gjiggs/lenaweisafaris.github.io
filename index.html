<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lenawei Safaris Dream Team</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Fonts for animated headline, safari feel -->
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: #fcfaf6;
      font-family: 'Quicksand', Arial, sans-serif;
      color: #232848;
      margin: 0;
      padding: 30px;
      min-height: 100vh;
      position: relative;
    }
    h1 {
      text-align: center;
      color: #b678ff;
      margin-bottom: 40px;
      font-family: 'Luckiest Guy', cursive, sans-serif;
      font-size: 2.5em;
      letter-spacing: 2px;
      animation: gradientMove 2.8s infinite linear;
      background: linear-gradient(90deg, #b678ff, #65fff1, #ffc56f, #b678ff);
      background-size: 300% 100%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    @keyframes gradientMove {
      0% { background-position: 0% 50%;}
      100% { background-position: 100% 50%;}
    }
    .controls-bar {
      text-align: center;
      margin-bottom: 28px;
      user-select: none;
    }
    .controls-bar button {
      margin: 0 8px 8px 0;
      background: linear-gradient(90deg, #b678ff 30%, #65fff1 100%);
      color: #232848;
      border: none;
      border-radius: 7px;
      font-weight: bold;
      font-size: 1em;
      padding: 8px 22px;
      cursor: pointer;
      box-shadow: 0 2px 10px #c08fff22;
      transition: background 0.18s, color 0.18s, transform 0.12s;
      outline: none;
    }
    .controls-bar button:active {
      transform: scale(0.97) rotate(-2deg);
      background: linear-gradient(90deg, #ffc56f, #fc5477);
      color: #fff;
    }
    .team-member {
      background: #fff;
      border-radius: 14px;
      margin-bottom: 20px;
      padding: 0;
      overflow: hidden;
      max-width: 650px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 2px 16px #c08fff1c, 0 0 0 5px var(--border-accent, #b678ff22);
      border: 2.5px solid var(--border-accent, #b678ff);
      transition: box-shadow 0.2s, border 0.2s;
      position: relative;
      animation: bounceIn 0.7s;
    }
    @keyframes bounceIn {
      0% { transform: scale(0.92) translateY(60px); opacity: 0; }
      60% { transform: scale(1.05) translateY(-10px);}
      100% { transform: scale(1) translateY(0); opacity: 1;}
    }
    .team-member[data-color="lucy"] { --border-accent: #b678ff; }
    .team-member[data-color="pauline"] { --border-accent: #65fff1; }
    .team-member[data-color="titus"] { --border-accent: #ffc56f; }
    .team-member[data-color="jackson"] { --border-accent: #a772e6; }
    .team-member[data-color="lucas"] { --border-accent: #ff4b6e; }
    .team-member[data-color="duo"] { --border-accent: #232848; }

    .dropdown-btn {
      width: 100%;
      background: linear-gradient(90deg, #b678ff 30%, #65fff1 100%);
      border: none;
      color: #232848;
      font-size: 1.2em;
      font-weight: bold;
      padding: 21px 22px 18px 22px;
      cursor: pointer;
      text-align: left;
      transition: background 0.2s, box-shadow 0.18s, color 0.18s;
      outline: none;
      border-bottom: 1.5px solid #e6e6ff;
      display: flex;
      align-items: center;
      position: relative;
      font-family: 'Luckiest Guy', cursive, sans-serif;
      letter-spacing: 1.2px;
    }
    .dropdown-btn span.avatar {
      margin-right: 18px;
      font-size: 1.5em;
      filter: drop-shadow(0 2px 4px #ffc56f66);
    }
    .dropdown-btn .arrow {
      margin-left: auto;
      font-size: 1.25em;
      transition: transform 0.2s;
    }
    .dropdown-btn.active .arrow {
      transform: rotate(90deg);
    }
    .dropdown-btn .funny-msg {
      font-size: 1em;
      color: #b678ff;
      margin-left: 26px;
      opacity: 0.95;
      display: none;
      font-family: 'Quicksand', Arial, sans-serif;
      font-weight: 700;
    }
    .dropdown-content {
      display: none;
      background: #f6f6fb;
      padding: 20px 28px 24px 34px;
      animation: fadeIn 0.3s;
    }
    .dropdown-content.opened {
      display: block;
    }
    .dropdown-content h3 {
      margin-top: 0;
      color: #b678ff;
      margin-bottom: 10px;
      font-family: 'Luckiest Guy', cursive, sans-serif;
      font-size: 1.17em;
      letter-spacing: 1px;
      text-shadow: 0 1px 6px #ffc56f33;
      transition: text-shadow 0.22s;
    }
    .dropdown-content ul {
      margin: 10px 0 0 20px;
      padding: 0;
      font-size: 1.04em;
      font-family: 'Quicksand', Arial, sans-serif;
    }
    .dropdown-content ul.roles-list li {
      margin-bottom: 6px;
      padding-left: 7px;
      border-left: 4px solid #b678ff33;
      background: linear-gradient(90deg,#fffbe4 85%,#ffc56f15 100%);
      border-radius: 4px;
      transition: background 0.15s, color 0.15s, border 0.15s;
      cursor: pointer;
      position: relative;
      font-weight: 500;
    }
    .dropdown-content ul.roles-list li:hover {
      background: linear-gradient(90deg,#ffc56f 90%,#ffc56f55 100%);
      color: #232848;
      border-left: 4px solid #fc5477;
      box-shadow: 0 3px 14px #ffc56f45;
    }
    .dropdown-content .edit-btn, .dropdown-content .suggest-btn {
      margin: 14px 7px 0 0;
      background: #65fff1;
      color: #232848;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 1em;
      padding: 7px 18px;
      cursor: pointer;
      box-shadow: 0 2px 8px #b678ff22;
      transition: background 0.17s, color 0.17s;
      display: inline-block;
    }
    .dropdown-content .edit-btn:hover,
    .dropdown-content .suggest-btn:hover {
      background: #b678ff;
      color: #fff;
    }
    .dropdown-content .last-updated {
      font-size: 0.92em;
      color: #888;
      margin-top: 18px;
      font-style: italic;
    }
    .dropdown-content .reset-btn {
      margin: 14px 0 0 7px;
      background: #ffc56f;
      color: #232848;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 0.98em;
      padding: 6px 16px;
      cursor: pointer;
      box-shadow: 0 1px 5px #ffc56f44;
      transition: background 0.15s;
    }
    .dropdown-content .reset-btn:hover { background: #fc5477; color: #fff; }
    .dropdown-content .save-btn, .dropdown-content .cancel-btn {
      margin: 12px 10px 0 0;
      padding: 7px 19px;
      border-radius: 6px;
      border: none;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      outline: none;
      font-family: 'Quicksand', Arial, sans-serif;
    }
    .dropdown-content .save-btn { background: #65fff1; color: #232848; }
    .dropdown-content .save-btn:hover { background: #b678ff; color: #fff; }
    .dropdown-content .cancel-btn { background: #eee; color: #232848; }
    .dropdown-content .cancel-btn:hover { background: #fc5477; color: #fff; }
    .dropdown-content .suggested-roles {
      margin-top: 14px;
      border-left: 3.5px solid #b678ff;
      padding-left: 12px;
      background: #fffbe4;
      border-radius: 6px;
    }
    .dropdown-content .suggested-roles .suggest-add {
      color: #65fff1;
      font-weight: bold;
      cursor: pointer;
      margin-left: 12px;
      transition: color 0.15s;
    }
    .dropdown-content .suggested-roles .suggest-add:hover {
      color: #b678ff;
      text-decoration: underline;
    }
    /* Modal styles */
    .modal-bg {
      position: fixed;
      inset: 0;
      z-index: 99999;
      background: rgba(36, 28, 62, 0.35);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 4px 40px #b678ff44;
      min-width: 320px;
      max-width: 90vw;
      text-align: center;
      padding: 2.3em 2em 2.2em 2em;
      position: relative;
      animation: fadeIn 0.3s;
      font-family: 'Quicksand', Arial, sans-serif;
    }
    .modal .modal-close {
      position: absolute;
      right: 16px;
      top: 12px;
      font-size: 1.5em;
      color: #b678ff;
      background: none;
      border: none;
      cursor: pointer;
    }
    .modal .modal-title {
      font-size: 1.25em;
      margin-bottom: 18px;
      color: #b678ff;
      font-family: 'Luckiest Guy', cursive, sans-serif;
      letter-spacing: 1.2px;
    }
    .modal input[type="password"] {
      width: 66%;
      padding: 10px 16px;
      font-size: 1.1em;
      margin: 12px 0;
      border-radius: 6px;
      border: 1.5px solid #b678ff;
      outline: none;
      letter-spacing: 1px;
      text-align: center;
    }
    .modal .modal-btn {
      background: #65fff1;
      color: #232848;
      border: none;
      border-radius: 7px;
      font-weight: bold;
      font-size: 1em;
      padding: 8px 22px;
      cursor: pointer;
      margin: 8px 8px 0 8px;
      transition: background 0.18s;
    }
    .modal .modal-btn:hover { background: #b678ff; color: #fff; }
    .modal .modal-err {
      color: #fc5477;
      font-size: 1em;
      margin-top: 8px;
      font-weight: bold;
      animation: shake 0.35s;
    }
    .modal .pass-check {
      font-size: 1.11em;
      font-weight: bold;
      margin-top: 6px;
      margin-bottom: 8px;
    }
    .modal .pass-correct {
      color: #65fff1;
      animation: bounceIn 0.6s;
      font-size: 1.18em;
    }
    .modal .pass-wrong {
      color: #fc5477;
      animation: shake 0.38s;
    }
    .modal .pass-hint {
      color: #ffc56f;
      font-size: 1em;
      margin-top: 6px;
      font-style: italic;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px);}
      to { opacity: 1; transform: translateY(0);}
    }
    @keyframes shake {
      10%, 90% { transform: translateX(-2px);}
      20%, 80% { transform: translateX(4px);}
      30%, 50%, 70% { transform: translateX(-6px);}
      40%, 60% { transform: translateX(6px);}
    }
    /* Funny popups */
    .funny-popup {
      position: fixed;
      left: 50%;
      top: 8%;
      transform: translateX(-50%);
      background: #ffc56f;
      color: #232848;
      border-radius: 12px;
      padding: 18px 38px;
      font-size: 1.15em;
      font-weight: bold;
      box-shadow: 0 4px 26px #b678ff44;
      z-index: 99998;
      pointer-events: none;
      animation: fadeIn 0.15s, funnyPopupAnim 2s;
      font-family: 'Quicksand', Arial, sans-serif;
      letter-spacing: 0.02em;
    }
    @keyframes funnyPopupAnim {
      0% { opacity: 0;}
      8% { opacity: 1;}
      80% { opacity: 1;}
      100% { opacity: 0;}
    }
    /* Confetti for save animation */
    .confetti {
      position: fixed;
      pointer-events: none;
      z-index: 100001;
      animation: confetti-fall 1.6s linear;
    }
    @keyframes confetti-fall {
      to {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }
    /* Mascot */
    .mascot {
      position: absolute;
      right: -50px;
      bottom: 10px;
      font-size: 2.3em;
      animation: mascot-walk 2s linear 1;
      pointer-events: none;
      z-index: 8;
    }
    @keyframes mascot-walk {
      0% { right: -50px; opacity: 0;}
      18% { opacity: 1;}
      70% { right: 80%; opacity: 1;}
      100% { right: 100%; opacity: 0;}
    }
    /* Progress bar */
    .progress-bar {
      width: 100%;
      height: 17px;
      background: #efefed;
      border-radius: 8px;
      margin: 18px 0 28px 0;
      box-shadow: 0 0 6px #65fff155;
      overflow: hidden;
      max-width: 650px;
      margin-left: auto;
      margin-right: auto;
      position: relative;
    }
    .progress-bar-inner {
      height: 100%;
      background: linear-gradient(90deg, #ffc56f, #65fff1);
      border-radius: 8px 0 0 8px;
      transition: width 0.7s cubic-bezier(.91,.11,.12,.91);
    }
    .progress-bar-label {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -55%);
      font-size: 0.97em;
      font-weight: bold;
      color: #232848;
      z-index: 2;
      letter-spacing: 0.04em;
      pointer-events: none;
      text-shadow: 0 1px 6px #fff, 0 1px 8px #ffc56f33;
    }
    @media (max-width: 700px) {
      .dropdown-content { padding: 11px 3vw 14px 2vw; }
      .modal { padding: 1.4em 0.4em 1.1em 0.4em; min-width: 72vw;}
      .team-member { max-width: 98vw; }
      .progress-bar { max-width: 98vw;}
    }
  </style>
</head>
<body>
  <h1 id="headline">üåü Lenawei Safaris Dream Team üåü</h1>

  <div class="progress-bar" id="team-progress-bar" style="display:none;">
    <div class="progress-bar-inner" id="progress-bar-inner"></div>
    <span class="progress-bar-label" id="progress-bar-label"></span>
  </div>

  <div class="controls-bar">
    <button id="showAllBtn">Show All</button>
    <button id="collapseAllBtn">Collapse All</button>
    <button id="randomFactBtn">Random Safari Fact</button>
    <button id="restoreAllBtn">Restore All</button>
    <button id="printBtn">Print</button>
  </div>

  <div id="team-list">
    <!-- Cards rendered here by JS -->
  </div>

  <script>
    // TEAM DATA (Structured for edit/save)
    const teamData = [
      {
        color: "lucy",
        name: "Lucy Kago",
        avatar: "ü¶Å",
        title: "Master of Impressions (Marketing & Brand Visionary)",
        intro: "Crafting unforgettable first impressions and shaping the Lenawei Safaris brand. From eye-catching campaigns to creative storytelling, Lucy ensures our message is as adventurous as our safaris.",
        roles: [
          "Build and maintain a powerful online and offline brand presence.",
          "Create exciting campaigns that target schools, churches, and corporate groups.",
          "Design captivating brochures and digital content that tell our story.",
          "Collaborate with team members to deliver consistent and compelling messaging.",
          "Form strong partnerships with organizations for exclusive safari experiences."
        ],
        owner: "lucy kago",
        updated: "2025-07-01 13:03:00"
      },
      {
        color: "pauline",
        name: "Pauline Tamara",
        avatar: "ü¶í",
        title: "Guest Happiness & Hospitality Negotiator",
        intro: "The voice behind our exceptional service‚ÄîPauline handles customer care with warmth and grace. She also negotiates the best accommodations to guarantee a comfortable and memorable experience.",
        roles: [
          "Be the friendly face and voice for all client interactions‚Äîbefore, during, and after safaris.",
          "Secure top-tier accommodations and facilities for every safari experience.",
          "Develop tailored safari packages for schools, church groups, and corporate retreats.",
          "Manage a smooth and efficient booking and inquiry system.",
          "Collect guest feedback to refine and elevate future safari experiences."
        ],
        owner: "pauline tamara",
        updated: "2025-07-01 13:03:00"
      },
      {
        color: "titus",
        name: "Titus Gitonga",
        avatar: "ü¶ì",
        title: "Journey Captain (Transport & Tour Operations)",
        intro: "From the moment the wheels start turning, Titus is in command. He ensures smooth transportation and oversees every tour with precision, ensuring our guests enjoy a safe and seamless adventure.",
        roles: [
          "Organize and oversee safe, reliable transportation for every safari.",
          "Craft a detailed tour checklist to guarantee smooth operations.",
          "Lead and supervise all safari activities, ensuring a flawless guest experience.",
          "Perform dry runs for new safari routes to ensure safety and excitement.",
          "Ensure every tour blends adventure, learning, and unforgettable memories."
        ],
        owner: "titus gitonga",
        updated: "2025-07-01 13:03:00"
      },
      {
        color: "jackson",
        name: "Jackson Wachiuri",
        avatar: "üêò",
        title: "Adventure Architect (Itinerary Design & Costing)",
        intro: "Jackson is the mastermind behind our exciting itineraries. With an eye for detail and value, he crafts well-planned journeys that deliver both adventure and affordability.",
        roles: [
          "Design exciting, customizable itineraries for schools, church groups, and corporate clients.",
          "Research and develop fresh, innovative routes and unique adventure experiences.",
          "Ensure all safari packages balance affordability and premium value.",
          "Adapt itineraries to fit client needs‚Äîwhether it‚Äôs a spiritual retreat or a fun team-building day.",
          "Work closely with the team to ensure smooth execution of every adventure."
        ],
        owner: "jackson wachiuri",
        updated: "2025-07-01 13:03:00"
      },
      {
        color: "lucas",
        name: "Lucas Bell",
        avatar: "ü¶è",
        title: "Innovation & Numbers Maestro (Technology & Finance)",
        intro: "Lucas blends tech-savvy brilliance with financial expertise. From managing digital platforms to balancing the books, he ensures our operations run smoothly and sustainably.",
        roles: [
          "Manage and enhance the company‚Äôs digital platforms for bookings and inquiries.",
          "Implement smooth and secure digital payment systems.",
          "Keep Lenawei‚Äôs finances in check with clear and transparent reporting.",
          "Use technology to improve customer experiences (virtual previews, live updates).",
          "Analyze financial and customer data to improve efficiency and profitability."
        ],
        owner: "lucas bell",
        updated: "2025-07-01 13:03:00"
      },
      {
        color: "duo",
        name: "Lucy Kago & Pauline Tamara",
        avatar: "ü¶ú",
        title: "The Dynamic Duo (Administrative Powerhouses)",
        intro: "Beyond their specialized roles, Lucy and Pauline keep the gears turning behind the scenes. Their administrative prowess keeps our records sharp and our team organized.",
        roles: [
          "Keep all administrative records, licenses, and legal documents in perfect order.",
          "Document every team meeting with clear minutes and action plans.",
          "Organize and manage the team‚Äôs calendar for tours, deadlines, and client engagements.",
          "Prepare professional documents (contracts, proposals, invoices) with flair.",
          "Ensure seamless communication between departments for smooth operations."
        ],
        owner: "lucy kago & pauline tamara",
        updated: "2025-07-01 13:03:00"
      }
    ];

    // Additional role suggestions for each member
    const roleSuggestions = {
      "Lucy Kago": [
        "Launch monthly ‚ÄúSafari Star‚Äù social media campaigns.",
        "Host webinar series for travel teachers.",
        "Design Lenawei Safari mascot merchandise.",
        "Develop influencer partnership program."
      ],
      "Pauline Tamara": [
        "Create guest welcome packs with local crafts.",
        "Organize annual ‚ÄúGuest Appreciation‚Äù gala.",
        "Develop emergency response protocol for guests.",
        "Setup a ‚ÄúSafari Memories‚Äù digital wall for guest stories."
      ],
      "Titus Gitonga": [
        "Train new drivers in eco-friendly practices.",
        "Develop ‚ÄúJunior Explorer‚Äù kids‚Äô tour program.",
        "Implement GPS tracking for all safari vehicles.",
        "Host quarterly safety drills for all guides."
      ],
      "Jackson Wachiuri": [
        "Research new eco-safari destinations.",
        "Launch ‚ÄúMystery Safari‚Äù adventure packages.",
        "Develop a ‚ÄúChoose Your Own Adventure‚Äù trip builder.",
        "Collaborate with local conservationists for unique experiences."
      ],
      "Lucas Bell": [
        "Integrate AI chat for instant guest support.",
        "Develop a mobile app for live safari updates.",
        "Launch ‚ÄúLenawei Loyalty‚Äù rewards program.",
        "Automate monthly financial report emails."
      ],
      "Lucy Kago & Pauline Tamara": [
        "Create digital onboarding for new staff.",
        "Maintain emergency contact trees.",
        "Organize monthly team-building retreats.",
        "Develop a ‚ÄúSafari Success‚Äù newsletter."
      ]
    };
    // Flirty/funny messages, facts, and celebration
    const funnyMsgs = [
      "Safari Queen in action! üëë",
      "Ready to conquer the savannah! ü¶Å",
      "Your vision is as sharp as a lion‚Äôs! ü¶Å",
      "That edit was smoother than a cheetah‚Äôs sprint!",
      "Safari stars always go the extra mile. ü¶í",
      "Hakuna Matata! All changes are reversible.",
      "You‚Äôre on the prowl for perfection, aren‚Äôt you?",
      "Careful, your edits are wilder than the Serengeti!",
      "Mission accomplished, explorer! ü¶ì",
      "You must have the heart of a lion to lead this team!"
    ];
    const randomFacts = [
      "Did you know? Giraffes only sleep for 5 minutes at a time!",
      "Zebras are actually black with white stripes.",
      "A group of flamingos is called a flamboyance.",
      "Elephants are the only animals that can't jump!",
      "Lions rest for 20 hours a day. True royalty!",
      "The cheetah is the fastest land animal, reaching speeds up to 70 mph.",
      "Warthogs run with their tails straight up like antennas.",
      "The African elephant is the largest land animal on Earth.",
      "Ostriches can run faster than horses.",
      "Why did the zebra join Lenawei? To stand out in the crowd!"
    ];
    // Mascot animals
    const mascots = ["ü¶Å", "ü¶í", "ü¶ì", "üêò", "ü¶è", "ü¶ú", "üêµ", "üêæ", "ü¶Å"];

    let failedAttempts = 0;
    let editSession = {}; // {memberName: expiryTimestamp}
    const EDITS_KEY = "lenawei_team_roles_edits_v3";
    const DEFAULTS_KEY = "lenawei_team_roles_defaults_v1";
    // Save default for "Restore All"
    if (!localStorage.getItem(DEFAULTS_KEY)) {
      localStorage.setItem(DEFAULTS_KEY, JSON.stringify(teamData));
    }

    function getSavedEdits() {
      return JSON.parse(localStorage.getItem(EDITS_KEY) || "{}");
    }
    function saveEdits(edits) {
      localStorage.setItem(EDITS_KEY, JSON.stringify(edits));
    }
    function restoreAllDefaults() {
      localStorage.removeItem(EDITS_KEY);
      showFunnyPopup("All roles are restored to original. Hakuna Matata!");
      renderTeam();
    }

    // RENDER TEAM MEMBERS
    function renderTeam() {
      const saved = getSavedEdits();
      const list = document.getElementById('team-list');
      list.innerHTML = "";
      let numCustomized = 0;
      teamData.forEach((member, idx) => {
        // If edited, merge in edits
        let roles = saved[member.name]?.roles || member.roles;
        let intro = saved[member.name]?.intro || member.intro;
        let updated = saved[member.name]?.updated || member.updated;
        if (saved[member.name]) numCustomized++;
        // Build card
        let card = document.createElement('div');
        card.className = "team-member";
        card.setAttribute("data-color", member.color);
        card.innerHTML = `
          <button class="dropdown-btn" data-index="${idx}">
            <span class="avatar">${member.avatar}</span>
            <span class="name-anim">${member.name}</span>
            <span class="arrow">&#9654;</span>
            <span class="funny-msg"></span>
          </button>
          <div class="dropdown-content" id="dropdown-content-${idx}">
            <h3>${member.title}</h3>
            <p class="intro-text">${intro}</p>
            <b>Key Responsibilities:</b>
            <ul class="roles-list" style="list-style-type: disc;" data-name="${member.name}">
              ${roles.map((r,i)=><li data-idx="${i}">${r}</li>).join('')}
            </ul>
            <button class="edit-btn" data-index="${idx}">Edit</button>
            <button class="suggest-btn" data-index="${idx}">Suggest More Roles</button>
            <button class="reset-btn" data-index="${idx}">Reset</button>
            <div class="last-updated">Last updated: ${updated}</div>
          </div>
        `;
        list.appendChild(card);
      });
      attachDropdownListeners();
      attachEditListeners();
      attachResetListeners();
      attachFunnyMsgListeners();
      attachSuggestListeners();
      showProgress(numCustomized, teamData.length);
    }

    // Progress bar
    function showProgress(num, total) {
      let bar = document.getElementById("team-progress-bar");
      let inner = document.getElementById("progress-bar-inner");
      let lbl = document.getElementById("progress-bar-label");
      let percent = Math.round((num/total)*100);
      bar.style.display = "block";
      inner.style.width = percent+"%";
      lbl.textContent = ${percent}% Team Spirit Customized;
    }

    // DROPDOWN LOGIC
    function attachDropdownListeners() {
      document.querySelectorAll('.dropdown-btn').forEach(btn => {
        btn.onclick = function(e) {
          e.stopPropagation();
          const idx = +btn.dataset.index;
          const content = document.getElementById(dropdown-content-${idx});
          const isOpen = content.classList.contains('opened');
          document.querySelectorAll('.dropdown-content').forEach(c => c.classList.remove('opened'));
          document.querySelectorAll('.dropdown-btn').forEach(b => b.classList.remove('active'));
          if (!isOpen) {
            content.classList.add('opened');
            btn.classList.add('active');
          }
        }
      });
      // Support swipe left/right for mobile
      let touchStartX = null;
      document.querySelectorAll('.team-member').forEach(card => {
        card.addEventListener('touchstart', function(e) {
          touchStartX = e.changedTouches[0].clientX;
        });
        card.addEventListener('touchend', function(e) {
          let dx = e.changedTouches[0].clientX - touchStartX;
          let btn = card.querySelector('.dropdown-btn');
          let idx = btn.dataset.index;
          if (dx > 40) { // right swipe: open
            document.querySelectorAll('.dropdown-content').forEach(c => c.classList.remove('opened'));
            document.querySelectorAll('.dropdown-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(dropdown-content-${idx}).classList.add('opened');
            btn.classList.add('active');
          }
          if (dx < -40) { // left swipe: close
            document.getElementById(dropdown-content-${idx}).classList.remove('opened');
            btn.classList.remove('active');
          }
        });
      });
      document.body.onclick = function(e){
        if (!e.target.classList.contains('dropdown-btn') && !e.target.closest('.dropdown-btn')) {
          document.querySelectorAll('.dropdown-content').forEach(c => c.classList.remove('opened'));
          document.querySelectorAll('.dropdown-btn').forEach(b => b.classList.remove('active'));
        }
      };
    }

    // SHOW/Collapse ALL
    document.getElementById("showAllBtn").onclick = function() {
      document.querySelectorAll('.dropdown-content').forEach(c => c.classList.add('opened'));
      document.querySelectorAll('.dropdown-btn').forEach(b => b.classList.add('active'));
    };
    document.getElementById("collapseAllBtn").onclick = function() {
      document.querySelectorAll('.dropdown-content').forEach(c => c.classList.remove('opened'));
      document.querySelectorAll('.dropdown-btn').forEach(b => b.classList.remove('active'));
    };

    // RESTORE ALL
    document.getElementById("restoreAllBtn").onclick = function() {
      if (confirm('Are you sure you want to restore all roles to original?')) {
        restoreAllDefaults();
      }
    };
    // PRINT
    document.getElementById("printBtn").onclick = function() {
      showFunnyPopup("Ready for the world to see your dream team!");
      setTimeout(()=>window.print(), 1400);
    };

    // FUNNY MSGS ON HOVER
    function attachFunnyMsgListeners() {
      document.querySelectorAll('.dropdown-btn').forEach(btn => {
        btn.onmouseenter = function() {
          const msg = funnyMsgs[Math.floor(Math.random() * funnyMsgs.length)];
          btn.querySelector('.funny-msg').innerText = msg;
          btn.querySelector('.funny-msg').style.display = "inline";
        };
        btn.onmouseleave = function() {
          btn.querySelector('.funny-msg').style.display = "none";
        }
      });
    }

    // RANDOM FACT
    document.getElementById("randomFactBtn").onclick = function() {
      showFunnyPopup(randomFacts[Math.floor(Math.random() * randomFacts.length)]);
    };

    // EDIT LOGIC (with password prompt, inline edit, save/cancel, confetti, mascot, undo/redo)
    function attachEditListeners() {
      document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.onclick = function() {
          const idx = +btn.dataset.index;
          const member = teamData[idx];
          // Check edit session
          let now = Date.now();
          if (editSession[member.name] && editSession[member.name] > now) {
            enterEditMode(idx, member);
            return;
          }
          showPasswordModal(member, () => {
            editSession[member.name] = Date.now() + 5*60*1000; // 5 min session
            enterEditMode(idx, member);
          });
        }
      });
    }
    function enterEditMode(idx, member) {
      const content = document.getElementById(dropdown-content-${idx});
      const ul = content.querySelector('.roles-list');
      const introP = content.querySelector('.intro-text');
      // Convert to editable
      ul.contentEditable = true;
      ul.style.background = "#fffbe4";
      ul.style.border = "1.8px dashed #b678ff";
      ul.style.cursor = "text";
      ul.style.outline = "none";
      introP.contentEditable = true;
      introP.style.background = "#fffbe4";
      introP.style.border = "1.8px dashed #b678ff";
      introP.style.cursor = "text";
      introP.style.outline = "none";
      // Animate border and font
      content.parentNode.style.boxShadow = "0 0 38px #ffc56f66";
      content.parentNode.style.borderColor = "#ffc56f";
      content.querySelector('h3').style.textShadow = "0 2px 14px #ffc56f66";
      // Add save/cancel
      if (!content.querySelector('.save-btn')) {
        let saveBtn = document.createElement('button');
        saveBtn.className = "save-btn";
        saveBtn.textContent = "Save";
        let cancelBtn = document.createElement('button');
        cancelBtn.className = "cancel-btn";
        cancelBtn.textContent = "Cancel";
        content.appendChild(saveBtn);
        content.appendChild(cancelBtn);

        saveBtn.onclick = function() {
          const newRoles = [];
          ul.querySelectorAll('li').forEach(li => {
            if (li.textContent.trim()) newRoles.push(li.textContent.trim());
          });
          if (newRoles.length === 0) return showFunnyPopup("Oops! A roleless explorer? Add at least one role.");
          const newIntro = introP.textContent.trim() || member.intro;
          // Save to localStorage
          const saved = getSavedEdits();
          saved[member.name] = {
            roles: newRoles,
            intro: newIntro,
            updated: getNowStr()
          };
          saveEdits(saved);
          showFunnyPopup("Your update is as fresh as the morning savannah breeze!");
          triggerConfetti();
          mascotWalk(content, idx);
          renderTeam();
        };
        cancelBtn.onclick = function() {
          renderTeam();
        };
      }
      // Drag-and-drop role reordering
      ul.querySelectorAll('li').forEach(li => {
        li.draggable = true;
        li.ondragstart = function(e) { e.dataTransfer.setData('roleIdx', li.dataset.idx); };
        li.ondragover = function(e) { e.preventDefault(); li.style.background = "#ffc56f55";}
        li.ondragleave = function() { li.style.background = ""; }
        li.ondrop = function(e) {
          e.preventDefault();
          let fromIdx = +e.dataTransfer.getData('roleIdx');
          let toIdx = +li.dataset.idx;
          if (fromIdx === toIdx) return;
          let lis = Array.from(ul.children);
          if (fromIdx < toIdx) ul.insertBefore(lis[fromIdx], lis[toIdx].nextSibling);
          else ul.insertBefore(lis[fromIdx], lis[toIdx]);
          lis.forEach((li,i)=>li.dataset.idx = i);
          showFunnyPopup("Whoosh! Role reordered.");
        }
      });
    }
    function getNowStr() {
      let d = new Date();
      return d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,'0')+"-"+String(d.getDate()).padStart(2,'0')+" "+String(d.getHours()).padStart(2,'0')+":"+String(d.getMinutes()).padStart(2,'0')+":"+String(d.getSeconds()).padStart(2,'0');
    }

    // RESET TO ORIGINAL
    function attachResetListeners() {
      document.querySelectorAll('.reset-btn').forEach(btn => {
        btn.onclick = function() {
          const idx = +btn.dataset.index;
          const member = teamData[idx];
          // Remove saved edit
          const saved = getSavedEdits();
          delete saved[member.name];
          saveEdits(saved);
          showFunnyPopup("Back to basics! The original roles are restored.");
          renderTeam();
        }
      });
    }

    // SUGGEST MORE ROLES
    function attachSuggestListeners() {
      document.querySelectorAll('.suggest-btn').forEach(btn => {
        btn.onclick = function() {
          const idx = +btn.dataset.index;
          const member = teamData[idx];
          let sugRoles = roleSuggestions[member.name] || ["Lead a surprise team safari adventure!"];
          let content = document.getElementById(dropdown-content-${idx});
          let sugDiv = content.querySelector('.suggested-roles');
          if (sugDiv) sugDiv.remove();
          sugDiv = document.createElement('div');
          sugDiv.className = 'suggested-roles';
          sugDiv.innerHTML = "<b>Suggested:</b><ul style='margin:7px 0 0 15px;'>" +
            sugRoles.map((r,i)=><li>${r} <span class="suggest-add" data-role="${r}">[add]</span></li>).join('') +
            "</ul>";
          content.appendChild(sugDiv);
          sugDiv.querySelectorAll('.suggest-add').forEach(addBtn => {
            addBtn.onclick = function() {
              let role = addBtn.dataset.role;
              let ul = content.querySelector('.roles-list');
              let li = document.createElement('li');
              li.textContent = role;
              ul.appendChild(li);
              addBtn.parentElement.style.opacity = "0.5";
              showFunnyPopup("Objective added! Adventure awaits.");
            };
          });
        }
      });
    }

    // PASSWORD MODAL
    function showPasswordModal(member, onSuccess) {
      showModal(
        `<div class="modal-title">Edit Roles for <b>${member.name}</b></div>
        <div>Only the owner can edit.<br>Enter password<br><span class="pass-hint">Hint: Lenawei Safaris</span></div>
        <input type="password" id="editPass" autocomplete="off" placeholder="Password...">
        <div id="pass-check"></div>
        <button class="modal-btn" id="passSubmit">Submit</button>
        <button class="modal-btn" onclick="closeModal()">Cancel</button>
        `
      );
      document.getElementById("editPass").focus();
      document.getElementById("passSubmit").onclick = checkPassword;
      document.getElementById("editPass").oninput = function() {
        document.getElementById("pass-check").innerHTML = "";
      };
      document.getElementById("editPass").onkeydown = function(e) {
        if (e.key === "Enter") checkPassword();
      };
      function checkPassword() {
        const entered = (document.getElementById("editPass").value || '').trim().toLowerCase();
        const owner = member.owner.replace(/[^a-z]/g,'').toLowerCase();
        const passOk = (entered === owner || entered === "lenawei safaris" || entered === "lenaweisafaris");
        let pc = document.getElementById("pass-check");
        if (passOk) {
          pc.innerHTML = '<span class="pass-correct">üêæ Correct! Welcome, explorer!</span>';
          setTimeout(()=>{ closeModal(); failedAttempts=0; onSuccess(); }, 700);
        } else {
          failedAttempts++;
          pc.innerHTML = '<span class="pass-wrong">'+getFunnyPasswordError()+'</span>';
          if (failedAttempts % 3 === 0) showFunnyPopup("Password wrong. Did a monkey type that?");
        }
      }
    }
    function getFunnyPasswordError() {
      const errMsgs = [
        "Oops! That‚Äôs not the secret handshake ü¶Ñ.",
        "Wrong password‚Äîno entry to the savannah!",
        "Still not right. Maybe try Lenawei Safaris?",
        "The jungle keeps its secrets. Try once more!",
        "Maybe you need a guide for this expedition!"
      ];
      return errMsgs[Math.min(failedAttempts-1, errMsgs.length-1)];
    }

    // MODAL GENERIC
    function showModal(html) {
      closeModal();
      let bg = document.createElement("div");
      bg.className = "modal-bg";
      bg.id = "modal-bg";
      let modal = document.createElement("div");
      modal.className = "modal";
      modal.innerHTML = <button class="modal-close" onclick="closeModal()" title="Close">&times;</button> + html;
      bg.appendChild(modal);
      document.body.appendChild(bg);
      bg.onclick = function(e) {
        if (e.target === bg) closeModal();
      }
    }
    function closeModal() {
      let bg = document.getElementById("modal-bg");
      if (bg) bg.remove();
    }

    // FUNNY POPUPS
    function showFunnyPopup(msg) {
      let pop = document.createElement('div');
      pop.className = 'funny-popup';
      pop.innerText = msg;
      document.body.appendChild(pop);
      setTimeout(()=>pop.remove(), 2100);
    }

    // CONFETTI CELEBRATION
    function triggerConfetti() {
      for (let i = 0; i < 17; i++) {
        setTimeout(() => {
          let c = document.createElement('div');
          c.className = 'confetti';
          c.style.left = Math.random()*96+"vw";
          c.style.top = "-30px";
          c.style.width = c.style.height = (8+Math.random()*14)+"px";
          c.style.background = ["#b678ff","#65fff1","#ffc56f","#a772e6","#fc5477"][Math.floor(Math.random()*5)];
          c.style.borderRadius = "50%";
          c.style.transform = rotate(${Math.random()*360}deg);
          document.body.appendChild(c);
          setTimeout(()=>c.remove(), 1700);
        }, i*85);
      }
    }

    // Mascot animation
    function mascotWalk(content, idx) {
      let mascot = document.createElement('span');
      mascot.className = 'mascot';
      mascot.innerText = mascots[idx % mascots.length];
      content.parentNode.appendChild(mascot);
      setTimeout(()=>mascot.remove(), 2100);
    }

    // ON LOAD
    renderTeam();
  </script>
</body>
</html>